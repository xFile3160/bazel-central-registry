load("@rules_cc//cc:cc_library.bzl", "cc_library")
load("@rules_cc//cc:cc_test.bzl", "cc_test")

cc_library(
    name = "wayland_test_runner",
    srcs = [
        "test-helpers.c",
        "test-runner.c",
    ],
    hdrs = ["test-runner.h"],
    deps = ["@wayland//:wayland_server"],
)

[
    cc_test(
        name = test_name,
        srcs = ["{}.c".format(test_name)],
        deps = [":wayland_test_runner"],
    )
    for test_name in [
        "array-test",
        "fixed-test",
        "interface-test",
        "list-test",
        "map-test",
        "message-test",
    ]
]

cc_test(
    name = "enum-validator-test",
    srcs = [
        "data/small-server-core.h",
        "enum-validator-test.c",
    ],
    deps = ["@wayland//:wayland_server"],
)
